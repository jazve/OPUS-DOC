# 03-格式模块系统

## 核心创新概述

格式模块系统是SSAP框架的核心创新，实现了"可控的统一文档体验"设计理念。通过"格式固定+内容动态"的机制，确保智能体输出的一致性、专业性和可控性。

## 设计理念

### 可控的统一文档体验

**核心思想**：
- **格式固定**：输出结构和呈现方式保持一致
- **内容动态**：根据具体场景和需求动态填充内容
- **统一调用**：使用`[Format.格式名称]`统一调用格式
- **自然融入**：格式调用自然嵌入工作流描述中

### 统一调用方式

**基础格式调用**：
- `[Format.分析格式]` - 调用分析阶段的格式模块
- `[Format.结果格式]` - 调用结果输出的格式模块  
- `[Format.交互格式]` - 调用用户交互的格式模块

**批量格式调用**：
- `[Formats.分析格式,结果格式]` - 同时应用多个格式模块
- `[Formats.交互格式,状态格式]` - 组合使用不同格式

**条件格式调用**：
- 根据内容类型和场景智能选择合适的格式模块

## 三大核心模块

### 1. 分析格式模块

**调用方式**：`[Format.分析格式]`

**应用场景**：
- 需求分析和问题拆解
- 数据分析和模式识别  
- 方案评估和比较
- 风险评估和影响分析

#### 固定模板样式
```
分析格式模块 = {
  ## 📊 分析概述
  **分析目标**：[分析的核心目标]
  **分析范围**：[分析的边界和范围]
  **关键假设**：[重要前提和假设]
  
  ## 🔍 详细分析
  ### 维度一：[分析维度名称]
  - **现状描述**：[当前状态]
  - **关键发现**：[重要发现]
  - **影响因素**：[影响因素列表]
  
  ### 维度二：[分析维度名称]
  - **现状描述**：[当前状态]
  - **关键发现**：[重要发现]
  - **影响因素**：[影响因素列表]
  
  ## ⚖️ 综合评估
  **优势**：[发现的优势]
  **劣势**：[发现的问题]
  **机会**：[潜在机会]
  **威胁**：[风险和威胁]
  
  ## 🎯 关键结论
  1. [核心结论一]
  2. [核心结论二]
  3. [核心结论三]
}
```

#### 动态编排模式
**格式特点**：
- 📊 清晰的概述和范围界定
- 🔍 结构化的多维度分析
- ⚖️ 系统性的评估总结
- 🎯 明确的关键结论

**使用示例**：
```pseudocode
FUNCTION 市场分析(市场数据):
BEGIN
  基于[Knowledge.市场研究方法]，运用[Skill.数据分析]处理市场数据
  
  // 固定模板模式
  通过[Format.分析格式:固定模板]呈现标准化分析结果
  
  // 或动态编排模式
  通过[Format.分析格式:动态编排]根据数据特点智能组织分析呈现
  
  RETURN 格式化的市场分析报告
END
```

### 2. 结果格式模块

**调用方式**：`[Format.结果格式]`

**应用场景**：
- 方案设计和推荐
- 报告生成和总结
- 决策建议和行动计划
- 成果交付和展示

#### 固定模板样式
```
结果格式模块 = {
  ## 🎯 执行摘要
  **核心方案**：[方案的核心内容]
  **预期效果**：[预期达到的效果]
  **关键指标**：[衡量成功的指标]
  
  ## 📋 详细方案
  ### 方案要素
  | 要素 | 描述 | 优先级 | 时间安排 |
  |------|------|--------|----------|
  | [要素1] | [具体描述] | [高/中/低] | [时间节点] |
  | [要素2] | [具体描述] | [高/中/低] | [时间节点] |
  
  ### 实施步骤
  1. **第一阶段**：[阶段目标]
     - [具体行动1]
     - [具体行动2]
     
  2. **第二阶段**：[阶段目标]
     - [具体行动1]
     - [具体行动2]
  
  ## ⚠️ 风险与对策
  **主要风险**：[识别的风险]
  **应对策略**：[具体的应对措施]
  **监控指标**：[风险监控的指标]
  
  ## 📈 预期成果
  **短期成果**：[1-3个月内的成果]
  **长期成果**：[6-12个月内的成果]
  **成功标准**：[判断成功的标准]
}
```

#### 动态编排模式
**格式特点**：
- 🎯 核心方案和预期效果
- 📋 详细的实施要素和步骤
- ⚠️ 完整的风险评估和对策
- 📈 明确的成果标准和指标

**使用示例**：
```pseudocode
FUNCTION 策略规划(规划需求):
BEGIN
  运用[Skills.战略分析,方案设计]制定策略方案
  
  // 固定模板模式 - 严格按照标准格式输出
  使用[Format.结果格式:固定模板]输出标准化方案文档
  
  // 动态编排模式 - 根据方案复杂度智能调整格式
  使用[Format.结果格式:动态编排]灵活呈现策略方案
  
  RETURN 格式化的策略规划方案
END
```

### 3. 交互格式模块

**调用方式**：`[Format.交互格式]`

**应用场景**：
- 状态反馈和进度显示
- 用户确认和选择
- 错误提示和帮助信息
- 流程控制和导航

#### 固定模板样式
```
交互格式模块 = {
  ## 状态显示格式
  🔄 **[状态描述]** - [详细说明]
  📊 **进度**：[当前进度] / [总进度]
  ⏰ **预计时间**：[预计完成时间]
  
  ## 用户确认格式
  ❓ **需要确认**：[确认事项描述]
  ✅ **选项A**：[选项描述]
  ✅ **选项B**：[选项描述]
  💭 **说明**：[补充说明信息]
  
  ## 等待用户输入
  ⏸️ **STOP_AND_WAIT**
  💬 请输入您的选择或反馈...
  
  ## 完成状态格式
  ✅ **[任务名称]** - 已完成
  📋 **输出内容**：[输出内容类型]
  🎯 **下一步**：[建议的下一步行动]
  
  ## 错误提示格式
  ⚠️ **错误类型**：[错误分类]
  🔍 **问题描述**：[具体问题说明]
  🔧 **建议解决**：[解决建议]
  📞 **需要帮助**：[获取帮助的方式]
}
```

#### 动态编排模式
**格式特点**：
- 🔄 直观的状态和进度显示
- ❓ 友好的确认和选择界面
- ⏸️ 清晰的等待和控制机制
- ⚠️ 有效的错误处理和帮助

**使用示例**：
```pseudocode
FUNCTION 互动式分析(用户需求):
BEGIN
  // 固定模板模式 - 标准交互格式
  使用[Format.交互格式:固定模板]显示标准化状态界面
  运用[Skill.需求分析]理解用户需求
  
  IF 需要用户确认 THEN:
    // 动态编排模式 - 根据确认内容调整交互样式
    通过[Format.交互格式:动态编排]展示个性化确认界面
    STOP_AND_WAIT
  END
  
  用[Format.交互格式]显示完成状态
  RETURN 分析结果
END
```

## 格式模式选择机制

### 1. 固定模板模式

**调用方式**：`[Format.格式名称:固定模板]`

**适用场景**：
- 需要严格格式一致性的正式文档
- 标准化报告和规范输出
- 企业级应用和合规要求
- 批量处理和模板复用

**使用示例**：
```pseudocode
FUNCTION 标准报告生成(数据):
BEGIN
  // 严格按照固定模板格式输出
  通过[Format.分析格式:固定模板]生成标准化分析部分
  使用[Format.结果格式:固定模板]生成标准化结论部分
  
  // 确保输出格式完全一致
  RETURN 标准化格式报告
END
```

### 2. 动态编排模式

**调用方式**：`[Format.格式名称:动态编排]`

**适用场景**：
- 内容结构变化较大的场景
- 需要根据数据特点调整呈现的情况
- 创新性和探索性任务
- 用户体验优先的交互场景

**使用示例**：
```pseudocode
FUNCTION 智能内容适配(内容数据):
BEGIN
  分析内容特征和用户需求
  
  // 根据内容特点动态调整格式
  IF 内容数据量大且复杂 THEN:
    通过[Format.分析格式:动态编排]采用数据密集型呈现
  ELSEIF 内容偏向决策支持 THEN:
    使用[Format.结果格式:动态编排]突出关键决策要素
  END
  
  RETURN 动态适配的格式化内容
END
```

### 3. 智能模式选择

**调用方式**：`[Format.格式名称:智能选择]`

**机制说明**：
```pseudocode
FUNCTION 智能格式选择(内容类型, 应用场景, 用户偏好):
BEGIN
  IF 应用场景 == "正式文档" OR 用户偏好 == "标准化" THEN:
    选择固定模板模式
  ELSEIF 内容结构复杂 OR 需要个性化呈现 THEN:
    选择动态编排模式
  ELSE:
    根据内容特征智能判断最佳模式
  END
  
  RETURN 最适合的格式模式
END
```

## 实际应用示例

### 1. 企业战略分析报告

```pseudocode
FUNCTION 企业战略分析(企业数据):
BEGIN
  基于[Knowledge.战略管理理论,行业分析框架]，运用[Skills.数据分析,战略思维]分析企业战略
  
  // 第一部分：使用固定模板确保分析结构一致性
  通过[Format.分析格式:固定模板]呈现：
  - 标准化的分析概述和范围
  - 结构化的SWOT分析
  - 统一格式的竞争环境分析
  - 规范化的关键结论
  
  // 第二部分：使用动态编排适应不同行业特点
  基于行业特征，用[Format.结果格式:动态编排]输出：
  - 针对行业特点的战略建议
  - 适应企业规模的实施计划
  - 个性化的风险控制方案
  
  RETURN 结合固定模板和动态编排的综合战略分析报告
END
```

### 2. 用户研究报告

```pseudocode
FUNCTION 用户研究报告(研究数据):
BEGIN
  运用[Knowledge.用户研究方法,数据分析理论]和[Skills.统计分析,洞察提取]处理研究数据
  
  // 数据分析部分：固定模板保证科学性
  通过[Format.分析格式:固定模板]展示：
  - 标准化的研究设计和方法
  - 统一格式的数据概览
  - 规范化的统计分析结果
  
  // 洞察和建议部分：动态编排提升可读性
  使用[Format.结果格式:动态编排]根据洞察特点灵活呈现：
  - 可视化的用户画像
  - 针对性的设计建议
  - 个性化的优化方案
  
  // 交互确认：智能选择最适合的交互方式
  通过[Format.交互格式:智能选择]与利益相关方确认关键发现
  
  RETURN 多模式融合的用户研究报告
END
```

### 3. 项目进度汇报

```pseudocode
FUNCTION 项目进度汇报(项目状态):
BEGIN
  基于[Knowledge.项目管理标准]，用[Skills.进度分析,风险识别]评估项目状态
  
  // 标准状态汇报：固定模板确保信息完整性
  定期使用[Format.交互格式:固定模板]显示：
  - 标准化的项目进度仪表板
  - 统一格式的里程碑状态
  - 规范化的风险预警信息
  
  // 问题分析：动态编排突出关键问题
  IF 发现重大问题 THEN:
    通过[Format.分析格式:动态编排]灵活分析问题根因
    
    // 解决方案：智能选择最合适的呈现方式
    用[Format.结果格式:智能选择]输出解决方案
  END
  
  RETURN 标准化与个性化结合的项目汇报
END
```

## 格式定制和扩展

### 1. 自定义固定模板

```pseudocode
FUNCTION 创建自定义固定模板(模板需求):
BEGIN
  // 分析模板规范要求
  基于[Knowledge.文档设计原则,信息架构]分析格式要求
  
  // 设计标准化模板
  运用[Skills.模板设计,结构化设计]创建固定格式框架：
  - 定义必需的格式元素
  - 设计统一的视觉样式
  - 规范内容占位符
  - 确保格式一致性
  
  // 验证模板有效性
  通过[Skills.可用性测试,格式验证]验证模板效果
  
  // 注册为新的固定模板
  将验证通过的模板注册为[Format.自定义格式名称:固定模板]
  
  RETURN 可复用的标准化格式模板
END
```

### 2. 扩展动态编排规则

```pseudocode
FUNCTION 扩展动态编排规则(编排需求):
BEGIN
  // 分析动态编排需求
  基于[Knowledge.自适应设计理论]分析编排要求
  
  // 设计智能编排逻辑
  运用[Skills.逻辑设计,条件判断]创建编排规则：
  - 内容特征识别规则
  - 格式适配决策树
  - 动态布局算法
  - 用户偏好学习机制
  
  // 测试编排效果
  通过[Skills.效果测试,用户体验评估]验证编排质量
  
  // 集成到动态编排系统
  将规则集成到[Format.格式名称:动态编排]机制中
  
  RETURN 增强的动态编排能力
END
```

## 最佳实践

### 1. 模式选择指南

```pseudocode
// ✅ 正确的模式选择
FUNCTION 智能模式选择示例():
BEGIN
  // 正式文档使用固定模板
  IF 输出用途 == "正式汇报" OR "合规文档" THEN:
    使用[Format.分析格式:固定模板]确保格式规范
  END
  
  // 探索性内容使用动态编排
  IF 内容类型 == "创新方案" OR "个性化建议" THEN:
    使用[Format.结果格式:动态编排]灵活呈现内容
  END
  
  // 不确定时使用智能选择
  ELSE:
    采用[Format.交互格式:智能选择]让系统自动判断
  END
END

// ❌ 错误的单一模式使用
无论什么场景都只使用固定模板或只使用动态编排
```

### 2. 模式组合策略

```pseudocode
// ✅ 有效的模式组合
FUNCTION 多模式组合示例():
BEGIN
  // 分析部分：固定模板保证科学性
  通过[Format.分析格式:固定模板]呈现标准化分析过程
  
  // 结果部分：动态编排提升针对性
  使用[Format.结果格式:动态编排]根据结果特点灵活呈现
  
  // 交互部分：智能选择优化体验
  采用[Format.交互格式:智能选择]适应用户习惯
END

// ❌ 混乱的模式混用
在同一部分内容中随意切换不同模式，缺乏逻辑
```

### 3. 一致性保证机制

```pseudocode
FUNCTION 格式一致性保证():
BEGIN
  // 固定模板一致性检查
  验证[Format.格式名称:固定模板]严格按照模板规范执行
  
  // 动态编排质量控制
  确保[Format.格式名称:动态编排]在灵活性与规范性间平衡
  
  // 智能选择决策透明
  记录[Format.格式名称:智能选择]的选择依据和过程
  
  RETURN 格式质量保证结果
END
```

## 质量保证和性能优化

### 1. 格式质量验证

```pseudocode
FUNCTION 格式质量检查(格式化输出):
BEGIN
  使用[Skills.格式验证,内容审查]检查格式质量：
  - 结构完整性验证
  - 内容填充正确性检查
  - 视觉呈现一致性确认
  - 用户体验友好性评估
  
  IF 发现格式问题 THEN:
    通过[Format.交互格式]提示问题并建议修复
    运用[Skills.格式修复,内容优化]自动修复或优化
  END
  
  RETURN 质量合格的格式化输出
END
```

### 2. 格式性能优化

```pseudocode
FUNCTION 格式性能优化():
BEGIN
  // 格式模板缓存
  将常用格式模板缓存，避免重复解析
  
  // 智能格式预测
  基于历史使用模式，预测可能需要的格式模块
  
  // 按需格式加载  
  仅在实际需要时加载特定格式模块
  
  // 格式渲染优化
  优化格式渲染算法，提升处理速度
END
```

## 总结

优化后的格式模块系统实现了完全的调用统一：

1. **统一调用方式**：`[Format.格式名称]`与整个SSAP框架保持一致
2. **自然语言融入**：格式调用自然嵌入到工作流描述中
3. **批量格式支持**：`[Formats.格式1,格式2]`提升处理效率
4. **智能格式选择**：根据内容和场景自动选择最合适的格式
5. **简单易用**：通过自然表达降低使用门槛

这种设计让格式模块系统既保持了强大的格式控制能力，又实现了与整个SSAP框架的完美融合，真正做到了"格式固定+内容动态+调用统一"的设计目标。

下一步：学习[工作流编排](./04-工作流编排.md)，掌握如何在工作流中自然使用统一的格式调用。 